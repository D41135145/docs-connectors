= Configure Web Services Addressing - Mule 4

Web Services Addressing (WS-Addressing) provides transport-neutral mechanisms to address web services and messages. To configure WS-Addressing in Anypoint Connector for Web Service Consumer (Web Service Consumer Connector) both in Anypoint Studio and XML editors, review the following guidelines.

* WS-Addressing adds only metadata to the SOAP message as headers
* Because Web Service Consumer Connector supports only Web Service Reliable Messaging (WS-ReliableMessaging) with synchronous calls, `ReplyTo` and `FaultTo` parameters can not be used with WS-Addressing

== Configure WS-Addressing in the Connector Global Element

The following example illustrates how to configure WS-Addressing in the Web Service Consumer Connector Global Element properties:

. In Studio, open the *Global Element Properties* window of the Web Service Consumer Connector.
. On the *Addressing* tab, select the addressing *Version* from the dropdown menu. Default version is `WSA2000508 (Default)`.
. In the *From* field, define a source endpoint address.
. Click *OK*.

The following screenshot shows the WS-Addressing configuration in Studio:

.Configure WS-Addressing Global Element
image::web-service-consumer-configure-transport.png[Configure WS-Addressing Global Element]

In the XML editor, the WS-Addressing configuration `<wsc:wsa>` is located under the Web Service Consumer Connector configuration `<wsc:config>`:

[source,xml,linenums]
----
<wsc:config name="WSA_Config">
	<wsc:connection wsdlLocation="http://www.host.com?WSDL" service="Service" port="Port" />
	<wsc:wsa wsaVersion="WSA200508" wsaFrom="http://localhost:8080/from"/>
</wsc:config>
----

== Configure WS-Addressing for the Consume Operation

You can configure WS-Addressing on top of the Web Service Consumer Connector *Consume* operation, which affects the generated SOAP request by adding some specific SOAP headers.

The following example illustrates shows how to configure WS-Addressing for the *Consume* operation:

. In the Studio canvas, select the *Consume* operation.
. In the *Consume* operation properties view, select the *Advanced* tab.
. In the *Addressing* section, define the following parameters: +

[%header%autowidth.spread]
|===
|Parameter |Description | Required
|*Version* | The addressing version to use. If not defined, the parameter inherits the value defined at the global configuration settings, otherwise overwrites the global settings value. |
|*From* | The source endpoint address. |
|*MessageID* | The message identifier. |
|*To* | The destination endpoint address. The value for this parameter is mandatory to use WS-Addressing | x
|*Action* | The semantic action associated with the web service operation. The value for this parameter is mandatory to use WS-Addressing | x
|*RelatesTo* | The message id to which the message relates. |
|===

The following screenshot shows the WS-Addressing for the *Consume* operation:

.Configure WS-Addressing Consume Operation
image::web-service-consumer-configure-transport.png[WS-Addressing Consume Operation]

In the XML editor, the WS-Addressing configuration `<wsc:addressing>` is included under the Web Service Consumer Connector *Consume* operation `<wsc:consume>`:

[source,xml,linenums]
----
<wsc:consume operation="sayHi" config-ref="WSA_Config" >
        <wsc:message>
		<wsc:body>#[payload]</wsc:body>
	</wsc:message>
	<wsc:addressing wsaAction="http://localhost/action" wsaTo="http://localhost/to" wsaMessageID="#['MessageIDCustom']" wsaVersion="WSA200408" wsaFrom="http://localhost/from" wsaRelatesTo="RelatesToMessageId"/>
</wsc:consume>
----

== WS-Addressing XML Example

Paste this code into the Studio XML editor to quickly load the flow for this example of a *Consume* operation with configured WS-Addressing:

[source,xml,linenums]
----
<?xml version="1.0" encoding="UTF-8"?>
<mule xmlns:wsc="http://www.mulesoft.org/schema/mule/wsc"
	xmlns="http://www.mulesoft.org/schema/mule/core"
	xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/wsc http://www.mulesoft.org/schema/mule/wsc/current/mule-wsc.xsd">
	<wsc:config name="WSA_Config" >
		<wsc:connection wsdlLocation="http://localhost:8080/helloWorld?wsdl" service="HelloWorldService" port="HelloWorldPort" address="http://localhost:8080/helloWorld" />
		<wsc:wsa wsaVersion="WSA200408" wsaTo="http://localhost/to" />
	</wsc:config>
	<flow name="WSA-Example" >
		<scheduler>
			<scheduling-strategy >
				<fixed-frequency />
			</scheduling-strategy>
		</scheduler>
		<wsc:consume operation="sayHi" config-ref="WSA_Config" >
			<wsc:message >
				<wsc:body >
                             #[
                             %dw 2.0
                             output application/xml
                             ns con http://service.soap.clients.namespace/
                             ---
                             con#sayHi: {
                                 arg0: "Sam"
                             }
                             ]>
                             </wsc:body>
			</wsc:message>
			<wsc:addressing wsaAction="http://localhost/action" wsaTo="http://localhost/to" />
		</wsc:consume>
	</flow>
</mule>
----

== See Also

* https://help.mulesoft.com[MuleSoft Help Center]
* xref:web-service-consumer-reference.adoc[Web Service Consumer Connector Reference]
